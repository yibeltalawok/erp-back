# Operators Performance Monitoring Software

<<<<<<< HEAD
## Requirement
=======
## Requirements
>>>>>>> dev-tefera
dfgyhudjk
```
### Node js LTS, and MongoDb
```

## Install Loopback

```

### yarn add global loopback-cli
```

## Project setup

```
yarn install
```

### Compiles

```
yarn watch
```

The project is generated by [LoopBack](http://loopback.io).

# 1. PushNotification Model

## Implementation Details

```
I have prepared a PushNotification model using a normal Loopback cli
Model creation technique. Then I followed the following steps.
```

### step 1: go to your firebase Project Settings -> service-accounts

### step 2. select node.js project and generate your private key

### step 3. download the serviceAccountKey.json file and save inside the \*./server folder of your loopback project

### step 4. Go to the push-notification.js file and add the code.

```
let admin = require("firebase-admin");
let serviceAccount = require("../../server/serviceAccountKey.json");
admin.initializeApp({
  type: "service_account",
  credential: admin.credential.cert(serviceAccount),
});
const db = admin.firestore();
```

### step 5. create an operation hook like the following. The `after save` method listens to `create` or `update` CRUDs.

##### Note: It it will not work if you use remote hook insteed of operation hook. Why? https://loopback.io/doc/en/lb3/Operation-hooks.html

```
module.exports = function (Pushnotification) {
  Pushnotification.observe("after save", function (ctx, next) {
      //write your custom code here.
  }
}
```

# 2. How do I use this Model to listen to my own model changes?

### Inside your `your-model-name`.js file ;

#### 1. Create a remote hook // you can also use operation hook if you want

###### I used remote hook in my case.

```
  LostTime.afterRemote("create", function (ctx, user, next) {
    let message = {
      title:"your message title",
      message: "your message body",
      nDate: new Date() //better to take a current date,
      receiver: "your mesage reciever role name",
    };
    ### import the PushNotification model
     let app = require("../../server/server");
     const { PushNotification } = app.models;
    PushNotification.create(message)
      .then(() => {
        console.log("Message stored in `PushNotification Model.`");
      })
      .catch(() => console.log("Unable to send MESSAGE"));
    next();
  }
```
